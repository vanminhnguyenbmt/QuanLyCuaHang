use master
CREATE DATABASE QLLKMT
GO
USE QLLKMT
GO

---Tạo bảng nhân viên
CREATE TABLE NHANVIEN
(
	MANV CHAR(5) NOT NULL PRIMARY KEY,
	TENNV NVARCHAR(50), 
	NGSINH SMALLDATETIME,
	GIOITINH NVARCHAR(3),
	DIACHI NVARCHAR(50),
	SDT VARCHAR(11),
	MALOAI CHAR(5)
)

---Tạo bảng phân loại nhân viên
CREATE TABLE PLNHANVIEN
(
	MALOAI CHAR(5) NOT NULL PRIMARY KEY,
	TENLOAI NVARCHAR(25),
)

---Tài khoản nhân viên
CREATE TABLE TKNHANVIEN
(
	MATK CHAR(5) NOT NULL PRIMARY KEY,
	MANV CHAR(5),
	TENDANGNHAP VARCHAR(20),
	MATKHAU VARCHAR(15)
)

---Tạo bảng sản phẩm
CREATE TABLE SANPHAM
(
	MASP CHAR(5) NOT NULL PRIMARY KEY,
	TENSP NVARCHAR(100), 
	TGBAOHANH int,
	SOLUONG int, 
	TRANGTHAI NVARCHAR(20),
	DONGIA INT,
	MALOAI CHAR(5),
	MANCC CHAR(5)
)

---Tạo bảng loại sản phẩm
CREATE TABLE LOAISP
(
	MALOAI CHAR(5) NOT NULL PRIMARY KEY,
	TENLOAI NVARCHAR(20)
)

---Tạo bảng nhà cung cấp
CREATE TABLE NHACUNGCAP
(
	MANCC CHAR(5) NOT NULL PRIMARY KEY,
	TENNCC NVARCHAR(50),
	SDT VARCHAR(11),
	DIACHI NVARCHAR(100)
)

---Tạo bảng hóa đơn nhập hàng
CREATE TABLE HDNHAPHANG
(
	MAHDNH CHAR(5) NOT NULL PRIMARY KEY,
	MANV CHAR(5),
	MANCC CHAR(5),
	NGAYNH SMALLDATETIME,
	TONGTIEN INT
)

---Tạo bảng chi tiết hóa đơn nhập hàng
CREATE TABLE CTHDNHAPHANG
(	
	MACTHDNH CHAR(5) NOT NULL PRIMARY KEY, 
	MAHDNH CHAR(5),
	MASP CHAR(5),
	SOLUONG INT,
	GIANHAP INT,
)

---Tạo bảng khách hàng
CREATE TABLE KHACHHANG
(
	MAKH CHAR(5) NOT NULL PRIMARY KEY,
	TENKH NVARCHAR(50),
	SDT VARCHAR(11),
	DIACHI NVARCHAR(100)
)

---Tạo bảng hóa đơn bán hàng
CREATE TABLE HDBANHANG
(
	MAHDBH CHAR(5) NOT NULL PRIMARY KEY,
	MANV CHAR(5),
	MAKH CHAR(5),
	NGAYBH SMALLDATETIME,
	THANHTIEN INT
)

---Tạo bảng chi tiết hóa đơn bán hàng
CREATE TABLE CTHDBANHANG
(
	MACTHDBH CHAR(5) NOT NULL PRIMARY KEY, 
	MAHDBH CHAR(5),
	MASP CHAR(5),
	SOLUONG INT,
)

---Tạo khóa ngoại cho bảng nhân viên
ALTER TABLE NHANVIEN ADD CONSTRAINT FK_NV_PLNV FOREIGN KEY(MALOAI) REFERENCES PLNHANVIEN(MALOAI)

---Tạo khóa ngoại cho bảng tài khoản
ALTER TABLE TKNHANVIEN ADD CONSTRAINT FK_TKNV_NV FOREIGN KEY(MANV) REFERENCES NHANVIEN(MANV)

---Tạo khóa ngoại cho bảng chi tiết hóa đơn bán hàng
ALTER TABLE CTHDBANHANG ADD CONSTRAINT FK_CTHDBH_HDBH FOREIGN KEY(MAHDBH) REFERENCES HDBANHANG(MAHDBH)
ALTER TABLE CTHDBANHANG ADD CONSTRAINT FK_CTHDBH_SP FOREIGN KEY(MASP) REFERENCES SANPHAM(MASP)

---Tạo khóa ngoại cho bảng hoá đơn bán hàng
ALTER TABLE HDBANHANG ADD CONSTRAINT FK_HDBH_NV FOREIGN KEY(MANV) REFERENCES NHANVIEN(MANV)
ALTER TABLE HDBANHANG ADD CONSTRAINT FK_HDBH_KH FOREIGN KEY(MAKH) REFERENCES KHACHHANG(MAKH)

---Tạo khóa ngoại cho bảng chi tiết hoá đơn nhập hàng
ALTER TABLE CTHDNHAPHANG ADD CONSTRAINT FK_CTHDNH_HDNH FOREIGN KEY(MAHDNH) REFERENCES HDNHAPHANG(MAHDNH)
ALTER TABLE CTHDNHAPHANG ADD CONSTRAINT FK_CTHDNH_SP FOREIGN KEY(MASP) REFERENCES SANPHAM(MASP)

---Tạo khóa ngoại cho bảng hoá đơn nhập hàng
ALTER TABLE HDNHAPHANG ADD CONSTRAINT FK_HDNH_NCC FOREIGN KEY(MANCC) REFERENCES NHACUNGCAP(MANCC)
ALTER TABLE HDNHAPHANG ADD CONSTRAINT FK_HDNH_NV FOREIGN KEY(MANV) REFERENCES NHANVIEN(MANV)


---Tạo khóa ngoại cho bảng sản phẩm
ALTER TABLE SANPHAM ADD CONSTRAINT FK_SP_NCC FOREIGN KEY(MANCC) REFERENCES NHACUNGCAP(MANCC)
ALTER TABLE SANPHAM ADD CONSTRAINT FK_SP_LSP FOREIGN KEY(MALOAI) REFERENCES LOAISP(MALOAI)

-------------------------------------------------------------------------
-------------------------------------------------------------------------
--------- NHẬP DỮ LIỆU --------------------------------------------------
-------------------------------------------------------------------------
use QLLKMT
--- LOAI NHAN VIEN ---
INSERT INTO PLNHANVIEN VALUES (N'LNV01',N'KINH DOANH');
INSERT INTO PLNHANVIEN VALUES (N'LNV02',N'KHO');
INSERT INTO PLNHANVIEN VALUES (N'LNV04',N'QUẢN LÝ');
INSERT INTO PLNHANVIEN VALUES (N'LNV03',N'ADMIN');

GO
--- NHAN VIEN ---
INSERT INTO NHANVIEN VALUES (N'NV001',N'ĐẶNG VĂN TRIỀU','1996-06-06 00:00:00',N'NAM',N'THỦ ĐỨC',0932221133,N'LNV01');
INSERT INTO NHANVIEN VALUES (N'NV002',N'NGUYỄN PHI HOÀNG VŨ','1996-05-02 00:00:00',N'NAM',N'HÓC MÔN',0932741345,N'LNV02');
INSERT INTO NHANVIEN VALUES (N'NV003',N'TRẦN QUAN THIÊN','1996-04-04 00:00:00',N'NAM',N'Q9',01266661241,N'LNV01');
INSERT INTO NHANVIEN VALUES (N'NV004',N'VĂN MINH NGUYÊN','1996-01-02 00:00:00',N'NAM',N'THỦ ĐỨC',01221234567,N'LNV03');
INSERT INTO NHANVIEN VALUES (N'NV005',N'NGUYỄN THỊ GẤU','1998-02-05 00:00:00',N'NỮ',N'TÂN BÌNH',0862111111,N'LNV04');
INSERT INTO NHANVIEN VALUES (N'NV006',N'TRẦN THỊ MEO MEO','1998-11-12 00:00:00',N'NỮ',N'TÂN PHÚ',01223456789,N'LNV04');

GO
--- TAI KHOAN ---
INSERT INTO TKNHANVIEN VALUES('TK001', 'NV004', 'admin', 'admin')


GO 
--- KHACH HANG --- 

INSERT INTO KHACHHANG VALUES (N'KH001',N'Đỗ Việt Linh',1669788679,N'Q1 HCM');
INSERT INTO KHACHHANG VALUES (N'KH002',N'Dương Kiết Mi',978178764,N'Q5 HCM');
INSERT INTO KHACHHANG VALUES (N'KH003',N'Lê Huỳnh Đưc',979809204,N'Q4 HCM');
INSERT INTO KHACHHANG VALUES (N'KH004',N'Lê Huỳnh Đức',905682529,N'BC HCM');
INSERT INTO KHACHHANG VALUES (N'KH005',N'lieu ngoc vinh',982725726,N'BÌNH DƯƠNG');
INSERT INTO KHACHHANG VALUES (N'KH006',N'Nguyễn Hồng Dương',937303282,N'CẦN THƠ');
INSERT INTO KHACHHANG VALUES (N'KH007',N'A Giang',974131489,N'THỦ ĐỨC HCM');
INSERT INTO KHACHHANG VALUES (N'KH008',N'An',984084034,N'BÌNH PHƯỚC');
INSERT INTO KHACHHANG VALUES (N'KH009',N'anh Đào',977557349,N'TÂY NINH');
INSERT INTO KHACHHANG VALUES (N'KH010',N'Anh Quân',1649616718,N'BIÊN HOÀ, ĐỒNG NAI');
INSERT INTO KHACHHANG VALUES (N'KH011',N'Anh Vĩ',1272389777,N'THỦ ĐỨC HCM');
INSERT INTO KHACHHANG VALUES (N'KH012',N'Ban Luong',986958908,N'BÌNH PHƯỚC');
INSERT INTO KHACHHANG VALUES (N'KH013',N'bao',1648129157,N'TÂY NINH');
INSERT INTO KHACHHANG VALUES (N'KH014',N'bích ngân',1673433886,N'Q4 HCM');
INSERT INTO KHACHHANG VALUES (N'KH015',N'bình lê thanh',988753023,N'BC HCM');
INSERT INTO KHACHHANG VALUES (N'KH016',N'Bùi Bé Thái',1656077115,N'BÌNH DƯƠNG');
INSERT INTO KHACHHANG VALUES (N'KH017',N'Bùi chí thiện',972907579,N'Q1 HCM');
INSERT INTO KHACHHANG VALUES (N'KH018',N'Bui Dang Dong',904054732,N'Q5 HCM');
INSERT INTO KHACHHANG VALUES (N'KH019',N'bùi đình du',1658102387,N'Q4 HCM');
INSERT INTO KHACHHANG VALUES (N'KH020',N'Bùi hiển vinh',1666240750,N'BC HCM');
INSERT INTO KHACHHANG VALUES (N'KH021',N'Bui Hoa Tan',983043195,N'BÌNH DƯƠNG');
INSERT INTO KHACHHANG VALUES (N'KH022',N'Bùi Hưng',976388281,N'CẦN THƠ');
INSERT INTO KHACHHANG VALUES (N'KH023',N'bui tan hai',1656077128,N'Q1 HCM');
INSERT INTO KHACHHANG VALUES (N'KH024',N'Bùi Tuấn Vũ',976096113,N'Q5 HCM');
INSERT INTO KHACHHANG VALUES (N'KH025',N'Bùi Văn Thao',912992158,N'Q4 HCM');
INSERT INTO KHACHHANG VALUES (N'KH026',N'Bùi Việt Hoàng',979389891,N'BC HCM');
INSERT INTO KHACHHANG VALUES (N'KH027',N'BƯƠNG TRẦN VĂN',979680065,N'BÌNH DƯƠNG');
INSERT INTO KHACHHANG VALUES (N'KH028',N'cái Tuấn',976764388,N'CẦN THƠ');
INSERT INTO KHACHHANG VALUES (N'KH029',N'Cao Thị Nhung',1653344585,N'THỦ ĐỨC HCM');
INSERT INTO KHACHHANG VALUES (N'KH030',N'Chau Phuong',975808375,N'BÌNH DƯƠNG');

GO 
--- LOAI SAN PHAM ---

INSERT INTO LOAISP VALUES ('ML001',N'LAPTOP');
INSERT INTO LOAISP VALUES ('ML002',N'MÀN HÌNH VI TÍNH');
INSERT INTO LOAISP VALUES ('ML003',N'BO MẠCH CHỦ');
INSERT INTO LOAISP VALUES ('ML004',N'CPU');
INSERT INTO LOAISP VALUES ('ML005',N'RAM');
INSERT INTO LOAISP VALUES ('ML006',N'Ổ CỨNG DI ĐỘNG');
INSERT INTO LOAISP VALUES ('ML007',N'Ổ CỨNG GẮN TRONG');
INSERT INTO LOAISP VALUES ('ML008',N'THẺ NHỚ');
INSERT INTO LOAISP VALUES ('ML009',N'USB');
INSERT INTO LOAISP VALUES ('ML010',N'NGUỒN MÁY TÍNH');
INSERT INTO LOAISP VALUES ('ML011',N'CASE');
INSERT INTO LOAISP VALUES ('ML012',N'CARD MÀN HÌNH');
INSERT INTO LOAISP VALUES ('ML013',N'BÀN PHÍM MÁY TÍNH');
INSERT INTO LOAISP VALUES ('ML014',N'CHUỘT MÁY TÍNH');
GO
--- NHA CUNG CAP ---

INSERT INTO NHACUNGCAP VALUES ('NCC01',N'Khoa Việt','02839407706',N'166 Xóm Chiếu, P. 14, Q. 4');
INSERT INTO NHACUNGCAP VALUES ('NCC02',N'Phạm Hưng','0996233333',N'182 Trần Quang Khải, P. Tân Định, Q. 1');
INSERT INTO NHACUNGCAP VALUES ('NCC03',N'SM&YOU','02862500939',N'9C/A Nguyễn ảnh Thủ, KP. 1, P. Trung Mỹ Tây, Q. 12');
INSERT INTO NHACUNGCAP VALUES ('NCC04',N'Việt Tâm','02862651180',N'373/172/22 Lý Thường Kiệt, P. 8, Q. Tân Bình, ');
INSERT INTO NHACUNGCAP VALUES ('NCC05',N'Liên Hiệp','02837402388',N'Số 157, Đường Nguyễn Thị Thập, P. Tân Phú, Q. 7');
GO
--- SAN PHAM --- 

INSERT INTO SANPHAM VALUES ('SP001',N'Dell LAT 6430 ATG- I3-3120U-4G-60G',12,5,N'CÒN HÀNG',4500000,'ML001','NCC01');
INSERT INTO SANPHAM VALUES ('SP002',N'Dell LAT 6430 ATG-I7-3720U-4G-500G',12,5,N'CÒN HÀNG',7400000,'ML001','NCC01');
INSERT INTO SANPHAM VALUES ('SP003',N'Dell INS 7537-I7-4510U-8G-1TB',12,5,N'CÒN HÀNG',10500000,'ML001','NCC01');
INSERT INTO SANPHAM VALUES ('SP004',N'Dell LAT 5540-I7-4600U-16G-320G',12,5,N'CÒN HÀNG',10500000,'ML001','NCC01');
INSERT INTO SANPHAM VALUES ('SP005',N'Dell LAT 5540-I5-4300U-4G-500G',12,5,N'CÒN HÀNG',8300000,'ML001','NCC01');
INSERT INTO SANPHAM VALUES ('SP006',N'Dell INS 5540-I7-4600U-16G-500G',12,5,N'CÒN HÀNG',10600000,'ML001','NCC01');
INSERT INTO SANPHAM VALUES ('SP007',N'Dell INS 5759-I5-6200U-8G-1TB',12,3,N'CÒN HÀNG',10400000,'ML001','NCC01');
INSERT INTO SANPHAM VALUES ('SP008',N'Dell INS 5737-I7-4500U-8G-1TB',12,3,N'CÒN HÀNG',10500000,'ML001','NCC01');
INSERT INTO SANPHAM VALUES ('SP009',N'Dell INS 5737-I7-4500U-16G-1TB',12,3,N'CÒN HÀNG',10800000,'ML001','NCC01');
INSERT INTO SANPHAM VALUES ('SP010',N'HP E2570P-I7-3520-4G-128G',12,5,N'CÒN HÀNG',7500000,'ML001','NCC01');
INSERT INTO SANPHAM VALUES ('SP011',N'HP E8560P-I7-2860-4G-500G',12,5,N'CÒN HÀNG',7000000,'ML001','NCC01');
INSERT INTO SANPHAM VALUES ('SP012',N'HP E8470P-I7-3740-4G-128G',12,5,N'CÒN HÀNG',7500000,'ML001','NCC01');
INSERT INTO SANPHAM VALUES ('SP013',N'LENOVO L430-I5-3320-4G-500G',12,5,N'CÒN HÀNG',4900000,'ML001','NCC01');
INSERT INTO SANPHAM VALUES ('SP014',N'LENOVO T510-I5-M520-4G-750G',12,5,N'CÒN HÀNG',4800000,'ML001','NCC01');
INSERT INTO SANPHAM VALUES ('SP015',N'LENOVO X230-I5-3320-4G-500G',12,5,N'CÒN HÀNG',5000000,'ML001','NCC01');
INSERT INTO SANPHAM VALUES ('SP016',N'LCD AOC E970 SWN',36,10,N'CÒN HÀNG',1465000,'ML002','NCC01');
INSERT INTO SANPHAM VALUES ('SP017',N'LCD AOC E2070 SWN',36,10,N'CÒN HÀNG',1545000,'ML002','NCC01');
INSERT INTO SANPHAM VALUES ('SP018',N'LCD AOC E2180 SWN',36,10,N'CÒN HÀNG',1765000,'ML002','NCC01');
INSERT INTO SANPHAM VALUES ('SP019',N'BENQ GW2270',36,10,N'CÒN HÀNG',2035000,'ML002','NCC01');
INSERT INTO SANPHAM VALUES ('SP020',N'BENQ GW2470H',36,10,N'CÒN HÀNG',2705000,'ML002','NCC01');
INSERT INTO SANPHAM VALUES ('SP021',N'HP V193B',24,10,N'CÒN HÀNG',1605000,'ML002','NCC01');
INSERT INTO SANPHAM VALUES ('SP022',N'LG 20MP48A-P',24,10,N'CÒN HÀNG',1665000,'ML002','NCC01');
INSERT INTO SANPHAM VALUES ('SP023',N'LG 22M47D',24,10,N'CÒN HÀNG',2195000,'ML002','NCC01');
INSERT INTO SANPHAM VALUES ('SP024',N'H81M-K CHÍNH HÃNG',36,10,N'CÒN HÀNG',1055000,'ML003','NCC02');
INSERT INTO SANPHAM VALUES ('SP025',N'H81M-E CHÍNH HÃNG',36,10,N'CÒN HÀNG',1230000,'ML003','NCC02');
INSERT INTO SANPHAM VALUES ('SP026',N'H81M-GAMING3 NEW',36,10,N'CÒN HÀNG',1500000,'ML003','NCC02');
INSERT INTO SANPHAM VALUES ('SP027',N'B85M-D3V-A NEW',36,8,N'CÒN HÀNG',1505000,'ML003','NCC02');
INSERT INTO SANPHAM VALUES ('SP028',N'GIGA B150M-D2V',36,6,N'CÒN HÀNG',1895000,'ML003','NCC02');
INSERT INTO SANPHAM VALUES ('SP029',N'GIGA B150M-HD3',36,2,N'CÒN HÀNG',1860000,'ML003','NCC02');
INSERT INTO SANPHAM VALUES ('SP030',N'ASUS AM1-E SOCKET AM1',36,5,N'CÒN HÀNG',850000,'ML003','NCC02');
INSERT INTO SANPHAM VALUES ('SP031',N'ASUS A68 HM-K SOCKET FM2+',36,2,N'CÒN HÀNG',1240000,'ML003','NCC02');
INSERT INTO SANPHAM VALUES ('SP032',N'CPU G1840 TRAY',36,8,N'CÒN HÀNG',755000,'ML004','NCC02');
INSERT INTO SANPHAM VALUES ('SP033',N'CPU G3250 BOX',36,5,N'CÒN HÀNG',1175000,'ML004','NCC02');
INSERT INTO SANPHAM VALUES ('SP034',N'CPU G3260 TRAY',36,2,N'CÒN HÀNG',1165000,'ML004','NCC02');
INSERT INTO SANPHAM VALUES ('SP035',N'CPU G3460 BOX',36,12,N'CÒN HÀNG',1515000,'ML004','NCC02');
INSERT INTO SANPHAM VALUES ('SP036',N'CPU I3 4160 BOX',36,10,N'CÒN HÀNG',2460000,'ML004','NCC02');
INSERT INTO SANPHAM VALUES ('SP037',N'CPU I3 6100 Box',36,15,N'CÒN HÀNG',2445000,'ML004','NCC02');
INSERT INTO SANPHAM VALUES ('SP038',N'CPU I3 6300 Box',36,10,N'CÒN HÀNG',3500000,'ML004','NCC02');
INSERT INTO SANPHAM VALUES ('SP039',N'DDRAM 3 1G/1333 MÁY BỘ',12,5,N'CÒN HÀNG',80000,'ML005','NCC02');
INSERT INTO SANPHAM VALUES ('SP040',N'DDRAM 3 2G/1333 MÁY BỘ',12,3,N'CÒN HÀNG',185000,'ML005','NCC02');
INSERT INTO SANPHAM VALUES ('SP041',N'DDR4 4G/2133  Kingston',36,9,N'CÒN HÀNG',775000,'ML005','NCC02');
INSERT INTO SANPHAM VALUES ('SP042',N'DDR4 8G/2133  Kingston',36,7,N'CÒN HÀNG',1495000,'ML005','NCC02');
INSERT INTO SANPHAM VALUES ('SP043',N'ADATA AHV620/HV100 500GB 2.5” USB 3.0',24,8,N'CÒN HÀNG',1020000,'ML006','NCC03');
INSERT INTO SANPHAM VALUES ('SP044',N'ADATA AHV620/HV100 1TbGB 2.5” USB 3.0',24,8,N'CÒN HÀNG',1260000,'ML006','NCC03');
INSERT INTO SANPHAM VALUES ('SP045',N'ADATA HD710 1TbGB 2.5” USB 3.0 chống sock',24,8,N'CÒN HÀNG',1505000,'ML006','NCC03');
INSERT INTO SANPHAM VALUES ('SP046',N'ADATA ADATA HV610 2Tb 2.5” USB 3.0 chống sock',24,9,N'CÒN HÀNG',2095000,'ML006','NCC03');
INSERT INTO SANPHAM VALUES ('SP047',N'Seagate Backup Plus 1TB SLIM 2.5” – USB 3.0 NEW',24,9,N'CÒN HÀNG',1555000,'ML006','NCC03');
INSERT INTO SANPHAM VALUES ('SP048',N'Seagate Backup Plus 2TB SLIM 2.5” – USB 3.0 NEW',24,9,N'CÒN HÀNG',2955000,'ML006','NCC03');
INSERT INTO SANPHAM VALUES ('SP049',N'Hitachi  2.5'' - 500G – USB 3.0 Touro 5400 vòng',24,8,N'CÒN HÀNG',1125000,'ML006','NCC03');
INSERT INTO SANPHAM VALUES ('SP050',N'Hitachi  2.5'' - 1TB – USB 3.0 Touro 5400 vòng',24,9,N'CÒN HÀNG',1305000,'ML006','NCC03');
INSERT INTO SANPHAM VALUES ('SP051',N'HDD Seagate 160Gb SATA 3 Mỏng',12,10,N'CÒN HÀNG',275000,'ML007','NCC03');
INSERT INTO SANPHAM VALUES ('SP052',N'HDD Seagate 250Gb SATA 3',12,21,N'CÒN HÀNG',395000,'ML007','NCC03');
INSERT INTO SANPHAM VALUES ('SP053',N'HDD Seagate 250Gb SATA 3 CTY Mỏng',24,20,N'CÒN HÀNG',430000,'ML007','NCC03');
INSERT INTO SANPHAM VALUES ('SP054',N'HDD Seagate 500Gb SATA 3 CTY Mỏng',24,10,N'CÒN HÀNG',770000,'ML007','NCC03');
INSERT INTO SANPHAM VALUES ('SP055',N'HDD Seagate 1TB SATA 3 Chính hãng',24,12,N'CÒN HÀNG',1100000,'ML007','NCC03');
INSERT INTO SANPHAM VALUES ('SP056',N'HDD Seagate 2TB SATA 3 Chính hãng',24,5,N'CÒN HÀNG',1705000,'ML007','NCC03');
INSERT INTO SANPHAM VALUES ('SP057',N'HDD Western 250G Sata Blue CH',24,9,N'CÒN HÀNG',800000,'ML007','NCC03');
INSERT INTO SANPHAM VALUES ('SP058',N'HDD Western 500G Sata Blue CH',24,9,N'CÒN HÀNG',995000,'ML007','NCC03');
INSERT INTO SANPHAM VALUES ('SP059',N'HDD Western 1TB Sata Blue/Green CH',24,3,N'CÒN HÀNG',1065000,'ML007','NCC03');
INSERT INTO SANPHAM VALUES ('SP060',N'Thẻ Micro SD TOSHIBA 16G',36,10,N'CÒN HÀNG',160000,'ML008','NCC04');
INSERT INTO SANPHAM VALUES ('SP061',N'Thẻ Micro SD TOSHIBA 32G ',36,15,N'CÒN HÀNG',260000,'ML008','NCC04');
INSERT INTO SANPHAM VALUES ('SP062',N'Thẻ Micro SD TOSHIBA 64G ',36,12,N'CÒN HÀNG',465000,'ML008','NCC04');
INSERT INTO SANPHAM VALUES ('SP063',N'USB KINGSTON 8GB DATA TRAVELER USB 2.0',12,2,N'CÒN HÀNG',93000,'ML009','NCC04');
INSERT INTO SANPHAM VALUES ('SP064',N'KINGSTON 16G DT100G3 3.0',12,5,N'CÒN HÀNG',140000,'ML009','NCC04');
INSERT INTO SANPHAM VALUES ('SP065',N'KINGSTON 32G DT100G3 3.0',12,2,N'CÒN HÀNG',272000,'ML009','NCC04');
INSERT INTO SANPHAM VALUES ('SP066',N'Nguồn SP  600w – 24p – sata  Fan 12cm',12,15,N'CÒN HÀNG',170000,'ML010','NCC04');
INSERT INTO SANPHAM VALUES ('SP067',N'Nguồn SP  700w – 24p – sata  Fan 12cm',12,12,N'CÒN HÀNG',175000,'ML010','NCC04');
INSERT INTO SANPHAM VALUES ('SP068',N'Nguồn EMASTER EF-350 Gaming',12,11,N'CÒN HÀNG',360000,'ML010','NCC04');
INSERT INTO SANPHAM VALUES ('SP069',N'Nguồn EMASTER EF-400 Gaming',12,9,N'CÒN HÀNG',400000,'ML010','NCC04');
INSERT INTO SANPHAM VALUES ('SP071',N'CASE SP E6XXX',1,20,N'CÒN HÀNG',165000,'ML011','NCC04');
INSERT INTO SANPHAM VALUES ('SP072',N'CASE SP E8XXX',1,22,N'CÒN HÀNG',190000,'ML011','NCC04');
INSERT INTO SANPHAM VALUES ('SP073',N'CASE VENUS 010-011-015',1,15,N'CÒN HÀNG',155000,'ML011','NCC04');
INSERT INTO SANPHAM VALUES ('SP074',N'CASE JETEK A20 ',1,17,N'CÒN HÀNG',170000,'ML011','NCC04');
INSERT INTO SANPHAM VALUES ('SP075',N'CASE JETEK X120',1,15,N'CÒN HÀNG',180000,'ML011','NCC04');
INSERT INTO SANPHAM VALUES ('SP076',N'VGA ASUS GT730 2GDR5 64bit',36,5,N'CÒN HÀNG',1459000,'ML012','NCC05');
INSERT INTO SANPHAM VALUES ('SP077',N'VGA ASUS GT740 2GDR5-OC 128bit',36,5,N'CÒN HÀNG',2357000,'ML012','NCC05');
INSERT INTO SANPHAM VALUES ('SP078',N'VGA ASUS GTX750 1GDR5-PHOC 128bit',36,6,N'CÒN HÀNG',2570000,'ML012','NCC05');
INSERT INTO SANPHAM VALUES ('SP079',N'VGA ASUS GTX750 2GDR5-PHOC 128bit',36,7,N'CÒN HÀNG',2770000,'ML012','NCC05');
INSERT INTO SANPHAM VALUES ('SP080',N'VGA GIGA GT N730 2GDR5 64bit',36,3,N'CÒN HÀNG',1520000,'ML012','NCC05');
INSERT INTO SANPHAM VALUES ('SP081',N'VGA GIGA GT740 N740D5OC-1GI',36,5,N'CÒN HÀNG',2295000,'ML012','NCC05');
INSERT INTO SANPHAM VALUES ('SP082',N'VGA GIGA GT740 N740D5OC-2GI',36,5,N'CÒN HÀNG',2465000,'ML012','NCC05');
INSERT INTO SANPHAM VALUES ('SP083',N'VGA ASUS R7260X-2GDR5 - OC',36,3,N'CÒN HÀNG',4218000,'ML012','NCC05');
INSERT INTO SANPHAM VALUES ('SP084',N'VGA ASUS R9270X-2GDR5 - DC2',36,4,N'CÒN HÀNG',4800000,'ML012','NCC05');
INSERT INTO SANPHAM VALUES ('SP085',N'VGA ASUS R9270X-2GDR5 - DC2T',36,4,N'CÒN HÀNG',5050000,'ML012','NCC05');
INSERT INTO SANPHAM VALUES ('SP086',N'Keyboard A4TECH KR83 USB',12,15,N'CÒN HÀNG',100000,'ML013','NCC05');
INSERT INTO SANPHAM VALUES ('SP087',N'Keyboard NEWMEN E360P PS2',12,20,N'CÒN HÀNG',159000,'ML013','NCC05');
INSERT INTO SANPHAM VALUES ('SP088',N'Keyboard NEWMEN E360U USB',12,22,N'CÒN HÀNG',164000,'ML013','NCC05');
INSERT INTO SANPHAM VALUES ('SP089',N'Keyboard COOLERLUS GX1 USB',12,21,N'CÒN HÀNG',120000,'ML013','NCC05');
INSERT INTO SANPHAM VALUES ('SP090',N'Mouse A4 Tech 720 PS2',12,25,N'CÒN HÀNG',50000,'ML014','NCC05');
INSERT INTO SANPHAM VALUES ('SP091',N'Mouse A4 Tech 720 USB',12,22,N'CÒN HÀNG',54000,'ML014','NCC05');
INSERT INTO SANPHAM VALUES ('SP092',N'Mouse A4 Tech N300 - Vtrack USB',12,23,N'CÒN HÀNG',80000,'ML014','NCC05');
INSERT INTO SANPHAM VALUES ('SP093',N'Mouse NEWMEN M180 USB Game',12,50,N'CÒN HÀNG',53000,'ML014','NCC05');
INSERT INTO SANPHAM VALUES ('SP094',N'Mouse NEWMEN G10 USB Game',12,15,N'CÒN HÀNG',125000,'ML014','NCC05');
INSERT INTO SANPHAM VALUES ('SP095',N'Mouse NEWMEN N500/G7 USB GAME',12,27,N'CÒN HÀNG',165000,'ML014','NCC05');
INSERT INTO SANPHAM VALUES ('SP096',N'Mouse Không Dây Logitech G402',12,10,N'CÒN HÀNG',850000,'ML014','NCC05');
INSERT INTO SANPHAM VALUES ('SP097',N'Mouse Không Dây Logitech G302',12,15,N'CÒN HÀNG',780000,'ML014','NCC05');
GO

--- HOA DON NHAP ---

INSERT INTO HDNHAPHANG VALUES (N'HN001',N'NV001',N'NCC01','2017-06-04 00:00:00',134000000);
INSERT INTO HDNHAPHANG VALUES (N'HN002',N'NV001',N'NCC02','2017-07-04 00:00:00',16950000);
INSERT INTO HDNHAPHANG VALUES (N'HN003',N'NV002',N'NCC01','2017-05-06 00:00:00',65000000);
INSERT INTO HDNHAPHANG VALUES (N'HN004',N'NV003',N'NCC03','2017-09-09 00:00:00',18500000);
INSERT INTO HDNHAPHANG VALUES (N'HN005',N'NV004',N'NCC02','2017-10-10 00:00:00',24450000);
INSERT INTO HDNHAPHANG VALUES (N'HN006',N'NV003',N'NCC04','2017-10-02 00:00:00',10550000);

GO
--- CTHD NHAP ---
INSERT INTO CTHDNHAPHANG VALUES (N'CN001',N'HN001',N'SP003',5,9600000);
INSERT INTO CTHDNHAPHANG VALUES (N'CN002',N'HN001',N'SP004',5,9500000);
INSERT INTO CTHDNHAPHANG VALUES (N'CN003',N'HN001',N'SP005',5,7700000);
INSERT INTO CTHDNHAPHANG VALUES (N'CN004',N'HN002',N'SP028',10,1330000);
INSERT INTO CTHDNHAPHANG VALUES (N'CN005',N'HN002',N'SP030',5,730000);
INSERT INTO CTHDNHAPHANG VALUES (N'CN006',N'HN003',N'SP001',5,3200000);
INSERT INTO CTHDNHAPHANG VALUES (N'CN007',N'HN003',N'SP016',10,1300000);
INSERT INTO CTHDNHAPHANG VALUES (N'CN008',N'HN003',N'SP017',5,1200000);
INSERT INTO CTHDNHAPHANG VALUES (N'CN009',N'HN003',N'SP012',5,6000000);
INSERT INTO CTHDNHAPHANG VALUES (N'CN010',N'HN004',N'SP051',10,155000);
INSERT INTO CTHDNHAPHANG VALUES (N'CN011',N'HN004',N'SP048',6,2200000);
INSERT INTO CTHDNHAPHANG VALUES (N'CN012',N'HN004',N'SP055',5,750000);
INSERT INTO CTHDNHAPHANG VALUES (N'CN013',N'HN005',N'SP032',15,550000);
INSERT INTO CTHDNHAPHANG VALUES (N'CN014',N'HN005',N'SP033',10,750000);
INSERT INTO CTHDNHAPHANG VALUES (N'CN015',N'HN005',N'SP039',20,50000);
INSERT INTO CTHDNHAPHANG VALUES (N'CN016',N'HN005',N'SP042',7,1100000);
INSERT INTO CTHDNHAPHANG VALUES (N'CN017',N'HN006',N'SP071',50,124000);
INSERT INTO CTHDNHAPHANG VALUES (N'CN018',N'HN006',N'SP074',30,145000);

--- HDBH, CTHDBH
GO
INSERT [dbo].[HDBANHANG] ([MAHDBH], [MANV], [MAKH], [NGAYBH], [THANHTIEN]) VALUES (N'HB001', N'NV001', N'KH001', CAST(N'2017-12-24T00:00:00' AS SmallDateTime), 11900000.0000)
INSERT [dbo].[HDBANHANG] ([MAHDBH], [MANV], [MAKH], [NGAYBH], [THANHTIEN]) VALUES (N'HB002', N'NV002', N'KH004', CAST(N'2017-12-27T00:00:00' AS SmallDateTime), 0.0000)
INSERT [dbo].[HDBANHANG] ([MAHDBH], [MANV], [MAKH], [NGAYBH], [THANHTIEN]) VALUES (N'HB003', N'NV004', N'KH007', CAST(N'2017-12-28T00:00:00' AS SmallDateTime), 0.0000)
INSERT [dbo].[HDBANHANG] ([MAHDBH], [MANV], [MAKH], [NGAYBH], [THANHTIEN]) VALUES (N'HB004', N'NV001', N'KH010', CAST(N'2017-12-28T00:00:00' AS SmallDateTime), 0.0000)
INSERT [dbo].[HDBANHANG] ([MAHDBH], [MANV], [MAKH], [NGAYBH], [THANHTIEN]) VALUES (N'HB005', N'NV002', N'KH014', CAST(N'2017-12-28T00:00:00' AS SmallDateTime), 0.0000)
INSERT [dbo].[HDBANHANG] ([MAHDBH], [MANV], [MAKH], [NGAYBH], [THANHTIEN]) VALUES (N'HB006', N'NV005', N'KH015', CAST(N'2017-12-28T00:00:00' AS SmallDateTime), 0.0000)
INSERT [dbo].[HDBANHANG] ([MAHDBH], [MANV], [MAKH], [NGAYBH], [THANHTIEN]) VALUES (N'HB007', N'NV006', N'KH024', CAST(N'2017-12-28T00:00:00' AS SmallDateTime), 0.0000)
INSERT [dbo].[HDBANHANG] ([MAHDBH], [MANV], [MAKH], [NGAYBH], [THANHTIEN]) VALUES (N'HB008', N'NV005', N'KH019', CAST(N'2017-12-28T00:00:00' AS SmallDateTime), 0.0000)
INSERT [dbo].[HDBANHANG] ([MAHDBH], [MANV], [MAKH], [NGAYBH], [THANHTIEN]) VALUES (N'HB009', N'NV004', N'KH029', CAST(N'2017-12-28T00:00:00' AS SmallDateTime), 0.0000)
INSERT [dbo].[HDBANHANG] ([MAHDBH], [MANV], [MAKH], [NGAYBH], [THANHTIEN]) VALUES (N'HB010', N'NV004', N'KH028', CAST(N'2017-12-28T00:00:00' AS SmallDateTime), 0.0000)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB001', N'HB001', N'SP001', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB002', N'HB001', N'SP002', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB003', N'HB004', N'SP005', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB004', N'HB004', N'SP005', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB005', N'HB004', N'SP005', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB006', N'HB004', N'SP005', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB007', N'HB004', N'SP005', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB008', N'HB004', N'SP005', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB009', N'HB004', N'SP005', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB010', N'HB004', N'SP005', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB011', N'HB004', N'SP005', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB012', N'HB004', N'SP005', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB013', N'HB004', N'SP005', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB014', N'HB004', N'SP005', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB015', N'HB004', N'SP005', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB016', N'HB004', N'SP005', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB017', N'HB004', N'SP005', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB018', N'HB004', N'SP005', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB019', N'HB004', N'SP005', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB020', N'HB004', N'SP005', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB021', N'HB004', N'SP005', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB022', N'HB004', N'SP005', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB023', N'HB004', N'SP005', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB024', N'HB004', N'SP005', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB025', N'HB004', N'SP005', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB026', N'HB004', N'SP005', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB027', N'HB004', N'SP005', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB028', N'HB004', N'SP005', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB029', N'HB004', N'SP005', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB030', N'HB004', N'SP005', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB031', N'HB004', N'SP005', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB032', N'HB004', N'SP005', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB033', N'HB004', N'SP005', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB034', N'HB005', N'SP020', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB035', N'HB006', N'SP014', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB036', N'HB006', N'SP031', 2)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB037', N'HB006', N'SP064', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB038', N'HB007', N'SP021', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB039', N'HB007', N'SP023', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB040', N'HB007', N'SP022', 2)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB041', N'HB008', N'SP023', 1)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB042', N'HB009', N'SP021', 2)
INSERT [dbo].[CTHDBANHANG] ([MACTHDBH], [MAHDBH], [MASP], [SOLUONG]) VALUES (N'CB043', N'HB010', N'SP025', 2)


-------------------------------------------------------------------------
-------------------------------------------------------------------------
--------- CAI DAT CA PROC --------------------------------------------------
-------------------------------------------------------------------------
GO
--- Load Nhân viên
CREATE PROC	Nhanvien_Load
AS
BEGIN
	SELECT NV.MANV, NV.TENNV, NV.NGSINH,NV.GIOITINH,NV.DIACHI, NV.SDT,NV.MALOAI, PL.TENLOAI 
	FROM NHANVIEN NV join PLNHANVIEN PL on NV.MALOAI = PL.MALOAI
END

---Thêm nhân viên
GO
CREATE PROC	Nhanvien_Insert(
	@MANV CHAR(5),
	@TENNV NVARCHAR(50),
	@NGSINH SMALLDATETIME,
	@GIOITINH NVARCHAR(3),
	@DIACHI NVARCHAR(50),
	@SDT VARCHAR(11),
	@MALOAI CHAR(5)
)
AS
BEGIN
	INSERT INTO NHANVIEN VALUES (@MANV, @TENNV, @NGSINH, @GIOITINH, @DIACHI, @SDT, @MALOAI)
END

---Xóa nhân viên
GO
CREATE PROC	Nhanvien_Detele(
	@MANV CHAR(5)
)
AS
BEGIN
	DELETE FROM NHANVIEN WHERE MANV = @MANV
END

---Sửa nhân viên
GO
CREATE PROC	Nhanvien_Update(
	@MANV CHAR(5),
	@TENNV NVARCHAR(50),
	@NGSINH SMALLDATETIME,
	@GIOITINH NVARCHAR(3),
	@DIACHI NVARCHAR(50),
	@SDT VARCHAR(11),
	@MALOAI CHAR(5)
)
AS
BEGIN
	UPDATE NHANVIEN 
	SET TENNV = @TENNV, 
		NGSINH = @NGSINH, 
		GIOITINH = @GIOITINH, 
		DIACHI = @DIACHI,
		SDT = @SDT,
		MALOAI = @MALOAI
	WHERE MANV = @MANV
END



--- Tìm kiếm nhân viên theo tên hoặc theo số điện thoại (Full Text Search)
GO
CREATE PROC NhanVien_Search(
	@CHUOI NVARCHAR(50)
)
AS
BEGIN
	SELECT * 
	FROM NHANVIEN NV join PLNHANVIEN PL on NV.MALOAI = PL.MALOAI
	WHERE FREETEXT(TENNV, @CHUOI) OR SDT LIKE '%' + @CHUOI + '%' OR TENNV LIKE N'%' +@CHUOI+ '%'
END

go
--load ten NV
GO
CREATE PROC NhanVien_SelectTenNV
AS
BEGIN
	SELECT MANV ,TENNV 
	FROM NHANVIEN
END

--load ma NV
go
CREATE PROC NhanVien_SelectMaNV(
	@TENNV NVARCHAR(50)
)
AS
BEGIN
	SELECT MANV 
	FROM NHANVIEN
	WHERE TENNV = @TENNV 
END

--chon loai nhan vien
GO
CREATE PROC	PLNhanVien_SelectLoaiNV
AS
BEGIN
	SELECT * FROM PLNHANVIEN
END

--- Thêm hóa đơn bán hàng
GO 
CREATE PROC HDBanHang_Insert(
	@MAHDBH CHAR(5),
	@MANV CHAR(5),
	@MAKH CHAR(5),
	@NGAYBH SMALLDATETIME,
	@THANHTIEN MONEY
)
AS
BEGIN
	INSERT INTO HDBANHANG VALUES (@MAHDBH, @MANV, @MAKH, @NGAYBH, @THANHTIEN)
END

--- Sửa hóa đơn bán hàng
GO 
CREATE PROC HDBanHang_Update(
	@MAHDBH CHAR(5),
	@MANV CHAR(5),
	@MAKH CHAR(5),
	@NGAYBH SMALLDATETIME,
	@THANHTIEN MONEY
)
AS
BEGIN
	UPDATE HDBANHANG 
	SET
		MAKH = @MAKH,
		NGAYBH = @NGAYBH,
		THANHTIEN = @THANHTIEN
	WHERE MAHDBH = @MAHDBH
END

--- Thêm chi tiết hóa đơn bán hàng
GO 
CREATE PROC CTHDBanHang_Insert(
	@MACTHDBH CHAR(5),
	@MAHDBH CHAR(5),
	@MASP CHAR(5),
	@SOLUONG INT
)
AS
BEGIN
	INSERT INTO CTHDBANHANG VALUES (@MACTHDBH, @MAHDBH, @MASP, @SOLUONG)
END

--- Xóa chi tiết hóa đơn bán hàng
GO
CREATE PROC	CTHDBanHang_Delete(
	@MACTHDBH CHAR(5)
)
AS
BEGIN
	DELETE FROM CTHDBANHANG WHERE MACTHDBH = @MACTHDBH
END

--- Sửa chi tiết hóa đơn bán hàng
GO 
CREATE PROC CTHDBanHang_Update(
	@MACTHDBH CHAR(5),
	@MAHDBH CHAR(5),
	@MASP CHAR(5),
	@SOLUONG INT
)
AS
BEGIN
	UPDATE CTHDBANHANG 
	SET 
		MASP = @MASP,
		SOLUONG = @SOLUONG
	WHERE MACTHDBH = @MACTHDBH
END

--- Load các chi tiết hóa đơn bán hàng của một hóa đơn
GO 
CREATE PROC CTHDBanHang_Load(
	@MAHDBH CHAR(5)
)
AS
BEGIN
	SELECT CTHDBH.MASP, CTHDBH.MACTHDBH, SP.TENSP, CTHDBH.SOLUONG 
	FROM CTHDBANHANG CTHDBH join SANPHAM SP on CTHDBH.MASP = SP.MASP
	WHERE MAHDBH = @MAHDBH
END

---Load Top 1 MaKH
GO
CREATE PROC	Khachhang_LoadTop1
AS
BEGIN
	SELECT TOP(1) MAKH
	FROM KHACHHANG
	GROUP BY MAKH
	ORDER BY MAKH DESC
END

---Load TENKH va MAKH
GO
CREATE PROC	Khachhang_LoadMaTen
AS
BEGIN
	SELECT MAKH, TENKH
	FROM KHACHHANG
END

--Load DIACHI va SDT KH
GO
CREATE PROC	Khachhang_LoadThongtinKH
(
	@MAKH CHAR(5)
)
AS
BEGIN
	SELECT DIACHI,SDT
	FROM KHACHHANG
	WHERE MAKH = @MAKH
END

--- Thêm khach hang
GO 
CREATE PROC Khachhang_Insert(
	@MAKH CHAR(5),
	@TENKH NVARCHAR(50),
	@SDT VARCHAR(11),
	@DIACHI NVARCHAR(100)
)
AS
BEGIN
	INSERT INTO KHACHHANG VALUES (@MAKH, @TENKH, @SDT, @DIACHI)
END

---Update Khach hang
--- Thêm khach hang
GO 
CREATE PROC Khachhang_Update(
	@MAKH CHAR(5),
	@TENKH NVARCHAR(50),
	@SDT VARCHAR(11),
	@DIACHI NVARCHAR(100)
)
AS
BEGIN
	UPDATE KHACHHANG 
	SET 
		TENKH = @TENKH,
		SDT = @SDT,
		DIACHI = @DIACHI
	WHERE MAKH = @MAKH
END

--- Load ten sp
GO 
CREATE PROC Sanpham_Load
AS
BEGIN
	SELECT MASP, TENSP
	FROM SANPHAM
END

--- chọn top 1 hóa đơn bán
GO
CREATE PROC HDBanHang_LoadTop1
AS
BEGIN
	SELECT TOP(1) MAHDBH
	FROM HDBANHANG
	GROUP BY MAHDBH
	ORDER BY MAHDBH DESC
END

-- load don gia SP
GO
CREATE PROC Sanpham_LoadDongia(
	@MASP CHAR(5)
)
AS
BEGIN
	SELECT DONGIA
	FROM SANPHAM
	WHERE MASP = @MASP
END

--- chọn top 1 chi tiet hóa đơn bán
GO
CREATE PROC CTHDBH_LoadTop1
AS
BEGIN
	SELECT TOP(1) MACTHDBH
	FROM CTHDBANHANG
	GROUP BY MACTHDBH
	ORDER BY MACTHDBH DESC
END

go
CREATE PROC LoaiSanPham_SelectAll
AS
BEGIN
	SELECT * FROM LOAISP
END

GO
CREATE PROC NCC_SelectAll
AS
BEGIN
	SELECT * FROM NHACUNGCAP
END

GO
CREATE PROC SanPham_MASP_TOP1
AS
BEGIN
	SELECT TOP(1) SP.MASP 
	FROM SANPHAM AS SP
	ORDER BY SP.MASP desc
END


GO
--- Lấy mã loại trong bản sản phẩm
CREATE PROC LoaiSanPham_MaLoai
AS
BEGIN
	SELECT SP.MALOAI 
	FROM SANPHAM AS SP, LOAISP AS LSP
	WHERE SP.MALOAI = LSP.MALOAI
END

GO
CREATE PROC NhaCungCap_TOP
AS
BEGIN
	SELECT TOP(1) MANCC
	FROM NHACUNGCAP
	GROUP BY MANCC
	ORDER BY MANCC DESC
END


GO
--- Lấy tất cả nhà cung cấp ra.
CREATE PROC NhaCungCap_SelectAll
AS
BEGIN
	SELECT * FROM NHACUNGCAP 
END

--- Lấy tất cả hóa đươn nhập hàng ra
GO
CREATE PROC HoaDonNhap_SelectAll
AS
BEGIN 
	SELECT * FROM HDNHAPHANG
END

--- Load MAHDNH, TENNV, TENNCC, NGAYNH, TONGTIEN
GO
CREATE PROC HoaDonNhap_Load
AS
BEGIN 
	SELECT HDNH.MAHDNH, HDNH.MANV,NV.TENNV, HDNH.MANCC, NCC.TENNCC, HDNH.NGAYNH, HDNH.TONGTIEN
	FROM HDNHAPHANG AS HDNH, NHANVIEN AS NV, NHACUNGCAP AS NCC
	WHERE HDNH.MANV = NV.MANV AND HDNH.MANCC = NCC.MANCC
END

--- Insert hóa đơn nhập
GO
CREATE PROC HoaDonNhap_Insert(
	@MAHDNH CHAR(5),
	@MANV CHAR(5),
	@MANCC CHAR(5),
	@NGAYNH SMALLDATETIME,
	@TONGTIEN MONEY
)
AS
BEGIN
	INSERT INTO HDNHAPHANG(MAHDNH, MANV, MANCC, NGAYNH, TONGTIEN) 
	VALUES (@MAHDNH, @MANV, @MANCC, @NGAYNH, @TONGTIEN)
END


--- Delete hóa đơn nhập
GO
CREATE PROC HoaDonNhap_Delete(
	@MAHDNH CHAR(5)
)
AS
BEGIN
	DELETE FROM CTHDNHAPHANG WHERE MAHDNH = @MAHDNH
	DELETE FROM HDNHAPHANG WHERE MAHDNH = @MAHDNH
END


--- Load chi tiết hóa đơn nhập
GO
CREATE PROC CTHDNhap_Load(
	@MAHDNH CHAR(5)
)
AS
BEGIN
	SELECT CTHDNH.MACTHDNH, CTHDNH.MAHDNH,CTHDNH.MASP, SP.TENSP, CTHDNH.SOLUONG, CTHDNH.GIANHAP 
	FROM SANPHAM AS SP, CTHDNHAPHANG AS CTHDNH
	WHERE CTHDNH.MASP = SP.MASP AND CTHDNH.MAHDNH = @MAHDNH
END

--- Thêm chi tiết hóa đơn nhập
GO
CREATE PROC CTHDNhap_Insert(
	@MACTHDNH CHAR(5),
	@MAHDNH CHAR(5),
	@MASP CHAR(5),
	@SOLUONG INT,
	@GIANHAP MONEY
)
AS
BEGIN
	INSERT INTO CTHDNHAPHANG(MACTHDNH, MAHDNH, MASP, SOLUONG, GIANHAP) 
	VALUES (@MACTHDNH, @MAHDNH, @MASP, @SOLUONG, @GIANHAP)
END

GO
--- Lấy Mã nhân viên, Tên nhân viên
CREATE PROC NhanVien_Select_Element
AS
BEGIN
	SELECT MANV, TENNV
	FROM NHANVIEN
END

GO
--- Lay danh sach NCC theo 
CREATE PROC NhaCungCap_Select_Element
AS
BEGIN
	SELECT MANCC, TENNCC
	FROM NHACUNGCAP
END

GO
--- Delete chi tiết hóa đơn nhập
CREATE PROC CTHDNhap_Delete(
	@MACTHDNH CHAR(5)
)
AS
BEGIN
	DELETE FROM CTHDNHAPHANG WHERE MACTHDNH = @MACTHDNH
END

GO
--- DELETE CI HDNHAP 
CREATE PROC CTHDNhap_Delete_NOMACT(
	@MAHDNH CHAR(5),
	@MASP CHAR(5)
)
AS
BEGIN
	DELETE FROM CTHDNHAPHANG WHERE MAHDNH = @MAHDNH AND MASP = @MASP
END

GO
--- SEARCH 
--- UPADATE HD NHAP HANG
CREATE PROC HDNhapHang_Update(
	@MAHDNH CHAR(5),
	@MANV CHAR(5),
	@MANCC CHAR(5),
	@NGAYNHAP DATETIME,
	@TONGTT MONEY
)
AS
BEGIN
	UPDATE HDNHAPHANG
	SET MANV = @MANV, MANCC = @MANCC, NGAYNH= @NGAYNHAP, TONGTIEN = @TONGTT
	WHERE MAHDNH = @MAHDNH
END

GO
--- UPDATE CTHD NHAP HANG ---
CREATE PROC CTHD_Update2(
	@MACTHDN CHAR(5),
	@MASP CHAR(5),
	@SOLUONG INT,
	@GIANHAP MONEY
)
AS
BEGIN
	UPDATE CTHDNHAPHANG
	SET MASP= @MASP, SOLUONG= @SOLUONG, GIANHAP = @GIANHAP
	WHERE MACTHDNH = @MACTHDN
END

GO
--- LAY MA HDNHAP LON NHAT ---
CREATE PROC HDN_MAHDN_TOP1
AS
BEGIN
	SELECT TOP 1 MAHDNH
	FROM HDNHAPHANG
	ORDER BY MAHDNH DESC
END

GO
--- --- LAY MA CTHDNHAP LON NHAT ---
CREATE PROC HDN_CTHDN_TOP1
AS
BEGIN
	SELECT TOP 1 MACTHDNH
	FROM CTHDNHAPHANG
	ORDER BY MACTHDNH DESC
END

GO
--- LOAD SP ---
CREATE PROC LOAD_SANPHAM_ELEMENT
AS
BEGIN
	SELECT MASP, TENSP
	FROM SANPHAM
END

GO
--- HOADONNHAPHANG _ WITH MAHD ---
CREATE PROC HDNH_WITHMAHD
( @MAHDNH CHAR(5)
)
AS
BEGIN
	SELECT HDNH.MAHDNH, HDNH.MANV,NV.TENNV, HDNH.MANCC, NCC.TENNCC, HDNH.NGAYNH, HDNH.TONGTIEN
	FROM HDNHAPHANG AS HDNH, NHANVIEN AS NV, NHACUNGCAP AS NCC
	WHERE HDNH.MANV = NV.MANV AND HDNH.MANCC = NCC.MANCC AND MAHDNH = @MAHDNH
END


--- Load lên tên sản phẩm ( Full-Text Search)
GO
CREATE PROC SANPHAM_SEARCH(
	@TENSP NVARCHAR(100)
)
AS
BEGIN
	SELECT *
	FROM SANPHAM
	WHERE FREETEXT(TENSP, @TENSP) OR TENSP LIKE '%' + @TENSP + '%'
END

--- Tính tổng tiền sản phẩm ở bảng HDBANHANG
GO
CREATE PROC HDBH_SumMoney(
	@MAHDBH CHAR(5)
)
AS
BEGIN
	SELECT SUM(CTHDBH.SOLUONG * SP.DONGIA) AS TONGTIENBH
	FROM CTHDBANHANG AS CTHDBH, SANPHAM AS SP
	WHERE CTHDBH.MASP = SP.MASP AND CTHDBH.MAHDBH = @MAHDBH
END

--- UPDATE Thành tiền của HDBANHANG
GO
CREATE PROC HDBANHANG_Update_ThanhTien(
	@THANHTIEN INT,
	@MAHDBH CHAR(5)
)
AS
BEGIN
	UPDATE HDBANHANG
	SET THANHTIEN = @THANHTIEN
	WHERE MAHDBH = @MAHDBH
END

--- Lấy thông tin đăng nhập
GO
CREATE PROC PLNhanVien_Check(
	@USERNAME VARCHAR(20),
	@PASSWORD VARCHAR(15)
)
AS
BEGIN
	SELECT * 
	FROM PLNHANVIEN
	WHERE TENDANGNHAP = @USERNAME AND MATKHAU = @PASSWORD
END

--- Kiểm tra MASP có tồn tại 1 trong 2 bảng CTHDBANHANG, CTHDNHAPHANG
GO
CREATE PROC SANPHAM_CHECK(
	@MASP CHAR(5)
)
AS
BEGIN
	SELECT SP.MASP 
	FROM SANPHAM AS SP
	WHERE MASP = @MASP AND MASP IN(
		SELECT DISTINCT SP.MASP 
		FROM SANPHAM AS SP 
		INNER JOIN CTHDBANHANG AS CTHDBH ON CTHDBH.MASP = SP.MASP
		UNION
		SELECT DISTINCT SP.MASP 
		FROM SANPHAM AS SP 
		INNER JOIN CTHDNHAPHANG AS CTHDNH ON CTHDNH.MASP = SP.MASP
	)
END

--- Load thông tin tài khoản và thông tin nhân viên lên
GO
CREATE PROC TKNhanVien_NhanVien_Load
AS
BEGIN
	SELECT TKNV.MATK, NV.MANV, NV.TENNV, TKNV.TENDANGNHAP, TKNV.MATKHAU, PLNV.TENLOAI
	FROM NHANVIEN AS NV FULL OUTER JOIN TKNHANVIEN AS TKNV ON TKNV.MANV = NV.MANV
	INNER JOIN PLNHANVIEN AS PLNV ON NV.MALOAI = PLNV.MALOAI
END

--- Select top 1 MATK DESC
GO
CREATE PROC TKNhanVien_Top1
AS
BEGIN
	SELECT TOP(1) MATK
	FROM TKNHANVIEN
	WHERE EXISTS (
		SELECT TKNV.MATK, NV.MANV, NV.TENNV, TKNV.TENDANGNHAP, TKNV.MATKHAU, PLNV.TENLOAI
		FROM NHANVIEN AS NV FULL OUTER JOIN TKNHANVIEN AS TKNV ON TKNV.MANV = NV.MANV
		INNER JOIN PLNHANVIEN AS PLNV ON NV.MALOAI = PLNV.MALOAI
	)
	ORDER BY MATK DESC
END

--- Thêm tài khoản cho nhân viên
GO
CREATE PROC TKNhanVien_Insert(
	@MATK CHAR(5),
	@MANV CHAR(5),
	@USERNAME VARCHAR(20),
	@PASSWORD VARCHAR(15)
)
AS
BEGIN
	INSERT INTO TKNHANVIEN
	VALUES(@MATK, @MANV, @USERNAME, @PASSWORD)
END

--- Xóa tài khoản nhân viên
GO
CREATE PROC TKNhanVien_Delete(
	@MATK CHAR(5)
)
AS
BEGIN
	DELETE 
	FROM TKNHANVIEN 
	WHERE MATK = @MATK
END

--- Sửa tài khoản nhân viên
GO
CREATE PROC TKNhanVien_Update(
	@MATK CHAR(5),
	@USERNAME VARCHAR(20),
	@PASSWORD VARCHAR(15)
)
AS
BEGIN
	UPDATE TKNHANVIEN
	SET TENDANGNHAP = @USERNAME,
		MATKHAU = @PASSWORD
	WHERE MATK = @MATK
END


--- Check username, password
GO
CREATE PROC TKNhanVien_Check(
	@USERNAME VARCHAR(20),
	@PASSWORD VARCHAR(15)
)
AS
BEGIN
	SELECT TKNV.MATK, NV.MANV, NV.TENNV, TKNV.TENDANGNHAP, TKNV.MATKHAU, PLNV.TENLOAI
	FROM NHANVIEN AS NV FULL OUTER JOIN TKNHANVIEN AS TKNV ON TKNV.MANV = NV.MANV
	INNER JOIN PLNHANVIEN AS PLNV ON NV.MALOAI = PLNV.MALOAI
	WHERE TKNV.TENDANGNHAP = @USERNAME AND TKNV.MATKHAU = @PASSWORD
END

--- Tru so luong cua 1 san pham
GO
CREATE PROC SANPHAM_CapnhatSL(
	@SOLUONG INT,
	@MASP CHAR(5)
)
AS
BEGIN
	UPDATE SANPHAM
	SET SOLUONG = @SOLUONG
	WHERE MASP = @MASP
END

--- lay so luong cua 1 san pham
GO
CREATE PROC SANPHAM_LaySL(
	@MASP CHAR(5)
)
AS
BEGIN
	SELECT SOLUONG
	FROM SANPHAM
	WHERE MASP = @MASP
END

---Load Hoa don ban hang
GO
CREATE PROC HDBANHANG_Load
AS
BEGIN
	SELECT HDBH.MAHDBH ,NV.TENNV ,KH.TENKH ,HDBH.NGAYBH ,HDBH.THANHTIEN
	FROM (NHANVIEN NV join HDBANHANG HDBH on HDBH.MANV = NV.MANV) join KHACHHANG KH on HDBH.MAKH = KH.MAKH
END

---Load Hoa don theo MaKH
GO
CREATE PROC HDBANHANG_LoadKH(
	@MAKH char(5)
)
AS
BEGIN
	SELECT HDBH.MAHDBH ,NV.TENNV ,KH.TENKH ,HDBH.NGAYBH ,HDBH.THANHTIEN
	FROM (NHANVIEN NV join HDBANHANG HDBH on HDBH.MANV = NV.MANV) join KHACHHANG KH on HDBH.MAKH = KH.MAKH
	WHERE HDBH.MAKH = @MAKH
END
---Load Hoa don theo MaNV
GO
CREATE PROC HDBANHANG_LoadNV(
	@MANV char(5)
)
AS
BEGIN
	SELECT HDBH.MAHDBH ,NV.TENNV ,KH.TENKH ,HDBH.NGAYBH ,HDBH.THANHTIEN
	FROM (NHANVIEN NV join HDBANHANG HDBH on HDBH.MANV = NV.MANV) join KHACHHANG KH on HDBH.MAKH = KH.MAKH
	WHERE HDBH.MANV = @MANV
END
--- Loc hoa don theo ngay thang
GO
CREATE PROC HDBANHANG_Loc(
	@START SMALLDATETIME,
	@END SMALLDATETIME
)
AS
BEGIN
	SELECT HDBH.MAHDBH ,NV.TENNV ,KH.TENKH ,HDBH.NGAYBH ,HDBH.THANHTIEN
	FROM (NHANVIEN NV join HDBANHANG HDBH on HDBH.MANV = NV.MANV) join KHACHHANG KH on HDBH.MAKH = KH.MAKH
	WHERE HDBH.NGAYBH >= @START and HDBH.NGAYBH <= @END
END

---SP load search
GO
CREATE PROC SP_LoadSearch(
	@CHUOI NVARCHAR(50)
)
AS
BEGIN
	SELECT MASP, TENSP , DONGIA
	FROM SANPHAM
	WHERE FREETEXT(TENSP, @CHUOI) OR TENSP LIKE N'%' +@CHUOI+ '%'
END
--Xoa tai khoan khi xoa nhan vien
GO
CREATE PROC TKNhanVien_DeleteMaNV(
	@MANV CHAR(5)
)
AS
BEGIN
	DELETE 
	FROM TKNHANVIEN 
	WHERE MANV = @MANV
END

---Kiem tra san pham da co trong hoa don hay chua
GO
CREATE PROC CheckSPinHDBH(
	@MASP CHAR(5),
	@MAHDBH CHAR(5)
)
AS
BEGIN
	SELECT *
	FROM CTHDBANHANG 
	WHERE MASP = @MASP and MAHDBH= @MAHDBH
END

--- Update so luong trong cthdbh
GO 
CREATE PROC CTHDBanHang_UpdateSL(
	@MACTHDBH CHAR(5),
	@MASP CHAR(5),
	@SOLUONG INT
)
AS
BEGIN
	UPDATE CTHDBANHANG 
	SET 
		SOLUONG = @SOLUONG
	WHERE MACTHDBH = @MACTHDBH and MASP = @MASP
END

---tao view cho report
GO
Create view ViewDSSP
as
	select CTHDBH.MAHDBH, SP.MASP, SP.TENSP, CTHDBH.SOLUONG, SP.DONGIA, (CTHDBH.SOLUONG*SP.DONGIA) as THANHTIEN, SP.TGBAOHANH
	from (SANPHAM SP join CTHDBANHANG CTHDBH on SP.MASP = CTHDBH.MASP)

---tao hoa don ban hang
GO
CREATE PROC RPHDBH(
	@MAHDBH CHAR(5)
)
AS
BEGIN
	SELECT CTHDBH.MAHDBH, SP.MASP, SP.TENSP, CTHDBH.SOLUONG, SP.DONGIA, (CTHDBH.SOLUONG*SP.DONGIA) as THANHTIEN, SP.TGBAOHANH, KH.TENKH, KH.DIACHI, KH.SDT, HDBH.MAHDBH, HDBH.NGAYBH, NV.TENNV
	FROM (SANPHAM SP join CTHDBANHANG CTHDBH on SP.MASP = CTHDBH.MASP) join ((KHACHHANG KH join HDBANHANG HDBH on KH.MAKH = HDBH.MAKH) join NHANVIEN NV on HDBH.MANV = NV.MANV ) on CTHDBH.MAHDBH = HDBH.MAHDBH
	WHERE CTHDBH.MAHDBH = @MAHDBH
END

--- load thong tin khi in hoa don
GO
CREATE PROC RPTTHDBH(
	@MAHDBH CHAR(5)
)
AS
BEGIN
	SELECT KH.TENKH, KH.DIACHI, KH.SDT, HDBH.MAHDBH, HDBH.NGAYBH, NV.TENNV
	FROM (KHACHHANG KH join HDBANHANG HDBH on KH.MAKH = HDBH.MAKH) join NHANVIEN NV on HDBH.MANV = NV.MANV 
	WHERE HDBH.MAHDBH = @MAHDBH
END

---- thống kê hóa đơn theo date
GO
CREATE PROC FILTER_HDBH(
	@DATEBEGIN SMALLDATETIME,
	@DATEEND SMALLDATETIME
)
AS
BEGIN
	SELECT HDBH.MAHDBH, NV.TENNV, HDBH.NGAYBH, HDBH.THANHTIEN
	FROM HDBANHANG AS HDBH JOIN KHACHHANG AS KH ON HDBH.MAKH = KH.MAKH
	JOIN NHANVIEN AS NV ON HDBH.MANV = NV.MANV
	WHERE HDBH.NGAYBH >= @DATEBEGIN AND HDBH.NGAYBH <= @DATEEND
END

---- thống kê hóa đơn theo date
GO
CREATE PROC TEST
AS
BEGIN
	SELECT HDBH.MAHDBH, NV.TENNV, HDBH.NGAYBH, HDBH.THANHTIEN
	FROM HDBANHANG AS HDBH JOIN KHACHHANG AS KH ON HDBH.MAKH = KH.MAKH
	JOIN NHANVIEN AS NV ON HDBH.MANV = NV.MANV
END
---
GO
CREATE PROC [dbo].[HDNH_WITHMANCC]
( @MANCC CHAR(5)
)
AS
BEGIN
SELECT HDNH.MAHDNH, HDNH.MANV,NV.TENNV, HDNH.MANCC, NCC.TENNCC, HDNH.NGAYNH, HDNH.TONGTIEN
FROM HDNHAPHANG AS HDNH, NHANVIEN AS NV, NHACUNGCAP AS NCC
WHERE HDNH.MANV = NV.MANV AND HDNH.MANCC = NCC.MANCC AND HDNH.MANCC = @MANCC
END
GO
---
CREATE PROC [dbo].[HDNH_WITHMANV]
( @MANV CHAR(5)
)
AS
BEGIN
SELECT HDNH.MAHDNH, HDNH.MANV,NV.TENNV, HDNH.MANCC, NCC.TENNCC, HDNH.NGAYNH, HDNH.TONGTIEN
FROM HDNHAPHANG AS HDNH, NHANVIEN AS NV, NHACUNGCAP AS NCC
WHERE HDNH.MANV = NV.MANV AND HDNH.MANCC = NCC.MANCC AND HDNH.MANV = @MANV
END
GO
---
CREATE PROC	[dbo].[HDNhapHang_Load_Day](
@DAYBEGIN SMALLDATETIME,
@DAYEND	SMALLDATETIME
)
AS
BEGIN
SELECT HDNH.MAHDNH, HDNH.MANV,NV.TENNV, HDNH.MANCC, NCC.TENNCC, HDNH.NGAYNH, HDNH.TONGTIEN
FROM HDNHAPHANG AS HDNH, NHANVIEN AS NV, NHACUNGCAP AS NCC
WHERE HDNH.MANV = NV.MANV AND HDNH.MANCC = NCC.MANCC AND 
NGAYNH >= @DAYBEGIN AND
NGAYNH <= @DAYEND	
END
GO
--- update Tong thanh tien HDNH ---
CREATE PROC UP_HDNH_THANHTOAN(
@TONGTIEN INT,
@MAHDNH CHAR(5)
)
AS 
BEGIN
UPDATE HDNHAPHANG
SET TONGTIEN = @TONGTIEN
WHERE MAHDNH = @MAHDNH
END
GO